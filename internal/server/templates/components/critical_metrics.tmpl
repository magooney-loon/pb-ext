{{define "critical_metrics"}}
<div class="panel">
    <div class="section-title">Critical System Metrics</div>
    
    <div class="metrics-grid">
        <!-- CPU -->
        <div class="metric-card">
            <div class="card-title">
                <svg class="metric-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v10M3.05 11A9 9 0 0 0 21 11M3.05 11A9 9 0 0 1 21 11"></path>
                    <rect x="7" y="7" width="10" height="10" rx="2"></rect>
                </svg>
                CPU Load
            </div>
            <div style="display: flex; align-items: baseline; gap: 5px;">
                <span class="main-value">{{printf "%.1f%%" (avgCPUUsage .SystemStats.CPUInfo)}}</span>
                <span class="unit">usage</span>
            </div>
            
            <div class="progress-bar">
                <div class="progress-value progress-blue" style="width: {{printf "%.1f%%" (avgCPUUsage .SystemStats.CPUInfo)}}"></div>
            </div>
            
            <div class="data-row">
                <div class="data-col">
                    <div class="label">Cores</div>
                    <div class="value">{{len .SystemStats.CPUInfo}}</div>
                </div>
                <div class="data-col">
                    <div class="label">Temp</div>
                    <div class="value">
                        {{if gt (index .SystemStats.CPUInfo 0).Temperature 0.0}}
                            {{printf "%.1f°C" (index .SystemStats.CPUInfo 0).Temperature}}
                        {{else}}
                            {{printf "%.1f°C" (getSystemTemp .SystemStats)}}
                        {{end}}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Memory -->
        <div class="metric-card">
            <div class="card-title">
                <svg class="metric-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M4 7v10c0 2 1 3 3 3h10c2 0 3-1 3-3V7c0-2-1-3-3-3H7c-2 0-3 1-3 3z"></path>
                    <path d="M9 17v-6"></path>
                    <path d="M12 17v-9"></path>
                    <path d="M15 17v-3"></path>
                </svg>
                Memory
            </div>
            <div style="display: flex; align-items: baseline; gap: 5px;">
                <span class="main-value">{{.MemoryUsageStr}}</span>
                <span class="unit">used</span>
            </div>
            
            <div class="progress-bar">
                <div class="progress-value {{if gt .SystemStats.MemoryInfo.UsedPercent 90.0}}progress-red{{else if gt .SystemStats.MemoryInfo.UsedPercent 70.0}}progress-yellow{{else}}progress-green{{end}}" 
                    style="width: {{printf "%.1f%%" .SystemStats.MemoryInfo.UsedPercent}}"></div>
            </div>
            
            <div class="data-row">
                <div class="data-col">
                    <div class="label">Total</div>
                    <div class="value">{{printf "%.1f GB" (divideFloat64 .SystemStats.MemoryInfo.Total 1073741824)}}</div>
                </div>
                <div class="data-col">
                    <div class="label">Free</div>
                    <div class="value">{{printf "%.1f GB" (divideFloat64 .SystemStats.MemoryInfo.Free 1073741824)}}</div>
                </div>
            </div>
        </div>
        
        <!-- Disk -->
        <div class="metric-card">
            <div class="card-title">
                <svg class="metric-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <circle cx="12" cy="12" r="3"></circle>
                </svg>
                Disk
            </div>
            <div style="display: flex; align-items: baseline; gap: 5px;">
                <span class="main-value">{{.DiskUsageStr}}</span>
                <span class="unit">used</span>
            </div>
            
            <div class="progress-bar">
                <div class="progress-value {{if gt (divide .SystemStats.DiskUsed .SystemStats.DiskTotal) 0.9}}progress-red{{else if gt (divide .SystemStats.DiskUsed .SystemStats.DiskTotal) 0.7}}progress-yellow{{else}}progress-green{{end}}" 
                    style="width: {{printf "%.1f%%" (multiply (divide .SystemStats.DiskUsed .SystemStats.DiskTotal) 100)}}"></div>
            </div>
            
            <div class="data-row">
                <div class="data-col">
                    <div class="label">Free</div>
                    <div class="value">{{printf "%.1f GB" (divideFloat64 .SystemStats.DiskFree 1073741824)}}</div>
                </div>
                <div class="data-col">
                    <div class="label">Files</div>
                    <div class="value">{{.SystemStats.ProcessStats.OpenFiles}}</div>
                </div>
                {{if hasDiskTemps .SystemStats}}
                <div class="data-col">
                    <div class="label">Temp</div>
                    <div class="value">{{printf "%.1f°C" (getDiskTemp .SystemStats)}}</div>
                </div>
                {{end}}
            </div>
        </div>
        
        <!-- Network -->
        <div class="metric-card">
            <div class="card-title">
                <svg class="metric-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 2 L15 8 L15 22 L9 22 L9 2 Z"></path>
                    <path d="M19 6 L21 6 L21 10 L19 10 L19 6 Z"></path>
                    <path d="M3 10 L5 10 L5 14 L3 14 L3 10 Z"></path>
                    <path d="M19 14 L21 14 L21 18 L19 18 L19 14 Z"></path>
                    <path d="M3 18 L5 18 L5 22 L3 22 L3 18 Z"></path>
                </svg>
                Network
            </div>
            <div style="display: flex; align-items: baseline; gap: 5px;">
                <span class="main-value">{{len .SystemStats.NetworkInterfaces}}</span>
                <span class="unit">interfaces</span>
            </div>
            
            <div style="margin-top: 6px;">
                <div class="data-row">
                    <div class="data-col">
                        <div class="label">Connections</div>
                        <div class="value">{{.SystemStats.NetworkConnections}}</div>
                    </div>
                    <div class="data-col">
                        <div class="label">Received</div>
                        <div class="value">{{printf "%.1f MB" (divideFloat64 .SystemStats.NetworkBytesRecv 1048576)}}</div>
                    </div>
                    <div class="data-col">
                        <div class="label">Sent</div>
                        <div class="value">{{printf "%.1f MB" (divideFloat64 .SystemStats.NetworkBytesSent 1048576)}}</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Process -->
        <div class="metric-card">
            <div class="card-title">
                <svg class="metric-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="2" y="4" width="20" height="16" rx="2"></rect>
                    <path d="M6 8h.01M6 12h.01M6 16h.01M10 8h8M10 12h8M10 16h8"></path>
                </svg>
                Process
            </div>
            <div style="display: flex; align-items: baseline; gap: 5px;">
                <span class="main-value">{{printf "%.1f%%" .SystemStats.ProcessStats.CPUPercent}}</span>
                <span class="unit">CPU</span>
            </div>
            
            <div class="progress-bar">
                <div class="progress-value progress-blue" style="width: {{printf "%.1f%%" .SystemStats.ProcessStats.CPUPercent}}"></div>
            </div>
            
            <div class="data-row">
                <div class="data-col">
                    <div class="label">PID</div>
                    <div class="value">{{.SystemStats.ProcessStats.PID}}</div>
                </div>
                <div class="data-col">
                    <div class="label">Threads</div>
                    <div class="value">{{.SystemStats.ProcessStats.NumThreads}}</div>
                </div>
            </div>
            
            <div class="data-row">
                <div class="data-col">
                    <div class="label">Memory</div>
                    <div class="value">{{printf "%.1f MB" (divideFloat64 .SystemStats.ProcessStats.RSS 1048576)}}</div>
                </div>
                <div class="data-col">
                    <div class="label">Virtual</div>
                    <div class="value">{{printf "%.1f MB" (divideFloat64 .SystemStats.ProcessStats.VMS 1048576)}}</div>
                </div>
            </div>
        </div>
        
        <!-- Runtime -->
        <div class="metric-card">
            <div class="card-title">
                <svg class="metric-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                    <path d="M2 17l10 5 10-5"></path>
                    <path d="M2 12l10 5 10-5"></path>
                </svg>
                Runtime
            </div>
            <div style="display: flex; align-items: baseline; gap: 5px;">
                <span class="main-value">{{.SystemStats.RuntimeStats.NumGoroutines}}</span>
                <span class="unit">goroutines</span>
            </div>
            
            <div style="margin-top: 6px;">
                <div class="data-row">
                    <div class="data-col">
                        <div class="label">GC Count</div>
                        <div class="value">{{.SystemStats.RuntimeStats.NumGC}}</div>
                    </div>
                    <div class="data-col">
                        <div class="label">Last GC</div>
                        <div class="value">{{.SystemStats.RuntimeStats.LastGCTime.Format "15:04:05"}}</div>
                    </div>
                </div>
                
                <div class="data-row">
                    <div class="data-col">
                        <div class="label">GC Pause</div>
                        <div class="value">{{printf "%.2fms" (divideFloat64 .SystemStats.RuntimeStats.GCPauseTotal 1000000)}}</div>
                    </div>
                    <div class="data-col">
                        <div class="label">Memory</div>
                        <div class="value">{{printf "%.1f MB" (divideFloat64 .SystemStats.RuntimeStats.AllocatedBytes 1048576)}}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{{end}} 