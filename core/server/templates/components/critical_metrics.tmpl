{{define "critical_metrics"}}
<div class="panel metrics-panel">
    <div class="section-title compact-title">CRITICAL SYSTEM METRICS</div>
    
    <div class="metrics-row">
        <!-- CPU -->
        <div class="stat-card">
            <div class="stat-header">
                <svg class="stat-icon cpu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect>
                    <rect x="9" y="9" width="6" height="6"></rect>
                </svg>
                <div class="stat-title">CPU Load</div>
            </div>
            
            <div class="stat-value">{{printf "%.1f%%" (avgCPUUsage .SystemStats.CPUInfo)}}<span class="stat-unit">usage</span></div>
            
            <div class="mini-progress">
                <div class="mini-progress-value" style="width: {{printf "%.1f%%" (avgCPUUsage .SystemStats.CPUInfo)}}"></div>
            </div>
            
            <div class="stat-details">
                <div class="detail-row">
                    <div class="detail-label">CORES</div>
                    <div class="detail-value">{{len .SystemStats.CPUInfo}}</div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">TEMP</div>
                    <div class="detail-value">
                        {{if gt (index .SystemStats.CPUInfo 0).Temperature 0.0}}
                            {{printf "%.1f°C" (index .SystemStats.CPUInfo 0).Temperature}}
                        {{else}}
                            {{printf "%.1f°C" (getSystemTemp .SystemStats)}}
                        {{end}}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Memory -->
        <div class="stat-card">
            <div class="stat-header">
                <svg class="stat-icon memory-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M4 7v10c0 2 1 3 3 3h10c2 0 3-1 3-3V7c0-2-1-3-3-3H7c-2 0-3 1-3 3z"></path>
                    <path d="M9 17v-6"></path>
                    <path d="M12 17v-9"></path>
                    <path d="M15 17v-3"></path>
                </svg>
                <div class="stat-title">Memory</div>
            </div>
            
            <div class="stat-value">{{printf "%.1f%%" .SystemStats.MemoryInfo.UsedPercent}}<span class="stat-unit">used</span></div>
            
            <div class="mini-progress memory-progress">
                <div class="mini-progress-value memory-progress-value" style="width: {{printf "%.1f%%" .SystemStats.MemoryInfo.UsedPercent}}"></div>
            </div>
            
            <div class="stat-details">
                <div class="detail-row">
                    <div class="detail-label">TOTAL</div>
                    <div class="detail-value">{{printf "%.1f GB" (divideFloat64 .SystemStats.MemoryInfo.Total 1073741824)}}</div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">USED</div>
                    <div class="detail-value">{{printf "%.2f GB" (divideFloat64 .SystemStats.MemoryInfo.Used 1073741824)}}</div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">FREE</div>
                    <div class="detail-value">{{printf "%.1f GB" (divideFloat64 .SystemStats.MemoryInfo.Free 1073741824)}}</div>
                </div>
            </div>
        </div>
        
        <!-- Disk -->
        <div class="stat-card">
            <div class="stat-header">
                <svg class="stat-icon disk-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <circle cx="12" cy="12" r="3"></circle>
                </svg>
                <div class="stat-title">Disk</div>
            </div>
            
            <div class="stat-value">{{printf "%.1f%%" (multiply (divide .SystemStats.DiskUsed .SystemStats.DiskTotal) 100)}}<span class="stat-unit">used</span></div>
            
            <div class="mini-progress disk-progress">
                <div class="mini-progress-value disk-progress-value" style="width: {{printf "%.1f%%" (multiply (divide .SystemStats.DiskUsed .SystemStats.DiskTotal) 100)}}"></div>
            </div>
            
            <div class="stat-details">
                <div class="detail-row">
                    <div class="detail-label">TOTAL</div>
                    <div class="detail-value">{{printf "%.1f GB" (divideFloat64 .SystemStats.DiskTotal 1073741824)}}</div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">USED</div>
                    <div class="detail-value">{{printf "%.2f GB" (divideFloat64 .SystemStats.DiskUsed 1073741824)}}</div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">FREE</div>
                    <div class="detail-value">{{printf "%.1f GB" (divideFloat64 .SystemStats.DiskFree 1073741824)}}</div>
                </div>
                {{if hasDiskTemps .SystemStats}}
                <div class="detail-row">
                    <div class="detail-label">TEMP</div>
                    <div class="detail-value">{{printf "%.1f°C" (getDiskTemp .SystemStats)}}</div>
                </div>
                {{end}}
            </div>
        </div>
        
        <!-- Network -->
        <div class="stat-card">
            <div class="stat-header">
                <svg class="stat-icon network-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="4" y="4" width="16" height="16" rx="2"></rect>
                    <path d="M4 12h16"></path>
                    <path d="M12 4v16"></path>
                </svg>
                <div class="stat-title">Network</div>
            </div>
            
            <div class="stat-value">{{len .SystemStats.NetworkInterfaces}}<span class="stat-unit">interfaces</span></div>
            
            <div class="network-details">
                <div class="network-detail-row">
                    <div class="detail-label">CONNECTIONS</div>
                    <div class="detail-value">{{.SystemStats.NetworkConnections}}</div>
                </div>
                <div class="network-detail-row">
                    <div class="detail-label">RECEIVED</div>
                    <div class="detail-value">{{printf "%.1f MB" (divideFloat64 .SystemStats.NetworkBytesRecv 1048576)}}</div>
                </div>
                <div class="network-detail-row">
                    <div class="detail-label">SENT</div>
                    <div class="detail-value">{{printf "%.1f MB" (divideFloat64 .SystemStats.NetworkBytesSent 1048576)}}</div>
                </div>
            </div>
        </div>
        
        <!-- Process -->
        <div class="stat-card">
            <div class="stat-header">
                <svg class="stat-icon process-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="2" y="4" width="20" height="16" rx="2"></rect>
                    <path d="M6 8h.01M6 12h.01M6 16h.01M10 8h8M10 12h8M10 16h8"></path>
                </svg>
                <div class="stat-title">Process</div>
            </div>
            
            <div class="stat-value">{{printf "%.1f%%" .SystemStats.ProcessStats.CPUPercent}}<span class="stat-unit">CPU</span></div>
            
            <div class="mini-progress process-progress">
                <div class="mini-progress-value process-progress-value" style="width: {{printf "%.1f%%" .SystemStats.ProcessStats.CPUPercent}}"></div>
            </div>
            
            <div class="stat-details">
                <div class="detail-row">
                    <div class="detail-label">PID</div>
                    <div class="detail-value">{{.SystemStats.ProcessStats.PID}}</div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">THREADS</div>
                    <div class="detail-value">{{.SystemStats.ProcessStats.NumThreads}}</div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">MEMORY</div>
                    <div class="detail-value">{{printf "%.1f MB" (divideFloat64 .SystemStats.ProcessStats.RSS 1048576)}}</div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">VIRTUAL</div>
                    <div class="detail-value">{{printf "%.1f MB" (divideFloat64 .SystemStats.ProcessStats.VMS 1048576)}}</div>
                </div>
            </div>
        </div>
        
        <!-- Runtime -->
        <div class="stat-card">
            <div class="stat-header">
                <svg class="stat-icon runtime-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                    <path d="M2 17l10 5 10-5"></path>
                    <path d="M2 12l10 5 10-5"></path>
                </svg>
                <div class="stat-title">Runtime</div>
            </div>
            
            <div class="stat-value">{{.SystemStats.RuntimeStats.NumGoroutines}}<span class="stat-unit">goroutines</span></div>
            
            <div class="runtime-details">
                <div class="detail-row">
                    <div class="detail-label">GC COUNT</div>
                    <div class="detail-value">{{.SystemStats.RuntimeStats.NumGC}}</div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">LAST GC</div>
                    <div class="detail-value">{{.SystemStats.RuntimeStats.LastGCTime.Format "15:04:05"}}</div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">GC PAUSE</div>
                    <div class="detail-value">{{printf "%.2fms" (divideFloat64 .SystemStats.RuntimeStats.GCPauseTotal 1000000)}}</div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">MEMORY</div>
                    <div class="detail-value">{{printf "%.1f MB" (divideFloat64 .SystemStats.RuntimeStats.AllocatedBytes 1048576)}}</div>
                </div>
            </div>
        </div>
    </div>
</div>
{{end}} 